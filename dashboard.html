<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard – etoile property</title>
  <link rel="stylesheet" href="style.css"/>

  <!-- Leaflet (for pick location) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script defer src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
<header class="topbar">
  <div class="brand"><a href="./" class="logo"><img src="etoile.jpg" alt="etoile property" /></a></div>
  <button class="hamburger" id="hamburgerBtn">☰</button>
  <nav class="menu" id="navMenu">
    <a href="./?type=sale">Buy</a>
    <a href="./?type=rent">Rent</a>
    <hr/>
    <a id="nav-admin" class="btn ghost hide" href="admin.html">Admin</a>
    <button id="btn-logout" class="btn pill">Logout</button>
  </nav>
</header>

<main class="wrap">
  <h1>Post a property</h1>

  <div class="panel">
    <form id="listingForm" class="form">
      <div class="grid-3">
        <select id="type" required>
          <option value="">Rent or Sale</option><option value="rent">Rent</option><option value="sale">Sale</option>
        </select>
        <select id="propertyType" required>
          <option value="">Property type</option>
          <option>apartment</option><option>house</option><option>villa</option><option>studio</option><option>commercial</option>
        </select>
        <select id="currency"><option>MUR</option><option>AED</option><option>USD</option></select>
      </div>

      <div class="grid-3">
        <input id="title" placeholder="Listing title" required/>
        <input id="price" type="number" placeholder="Price" required/>
        <input id="sizeSqm" type="number" min="0" placeholder="Size (sqm)"/>
      </div>

      <div class="grid-3">
        <input id="bedrooms" type="number" min="0" placeholder="Bedrooms"/>
        <input id="bathrooms" type="number" min="0" placeholder="Bathrooms"/>
        <input id="location" placeholder="Area / Street"/>
      </div>

      <div class="grid-3">
        <input id="city" placeholder="City" required/>
        <input id="country" placeholder="Country" required/>
        <input id="contactPhone" placeholder="Phone" required/>
      </div>

      <textarea id="description" rows="5" placeholder="Description" required></textarea>

      <fieldset class="fs">
        <legend>Images</legend>
        <input type="file" id="imagesInput" accept="image/*" multiple/>
        <div id="preview" class="preview"></div>
      </fieldset>

      <fieldset class="fs">
        <legend>Contact</legend>
        <div class="grid-2">
          <input id="contactName" placeholder="Your name" required/>
          <input id="contactEmail" type="email" placeholder="Email" required/>
        </div>
      </fieldset>

      <div class="panel" style="margin-top:10px">
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap">
          <strong>Listing location on map (optional):</strong>
          <button type="button" class="btn small" id="btn-pick-location">Pick on map</button>
          <span class="muted" id="pickedLatLng">No location selected</span>
        </div>
        <input type="hidden" id="lat">
        <input type="hidden" id="lng">
      </div>

      <button type="submit" class="btn primary">Submit for approval</button>
    </form>
  </div>

  <h2 class="section-title">Your listings</h2>
  <div id="myListings" class="grid"></div>
</main>

<template id="myCardTpl">
  <div class="card">
    <div class="card-img"></div>
    <div class="card-body">
      <h3 class="card-title"></h3>
      <p class="card-meta"></p>
      <p class="card-price"></p>
      <p class="badge"></p>
      <div class="actions">
        <button class="btn small">Edit</button>
        <button class="btn outline small delete">Delete</button>
      </div>
    </div>
  </div>
</template>

<!-- Map picker modal -->
<div id="mapPickModal" class="modal hide">
  <div class="modal-dialog" style="width:min(920px,95vw);padding:0">
    <button class="modal-close" id="closePick">×</button>
    <div style="height:min(70vh,560px); width:100%; overflow:hidden">
      <div id="pickMap" style="height:100%; width:100%"></div>
    </div>
    <div style="display:flex; gap:8px; padding:12px; border-top:1px solid var(--line);">
      <button id="savePick" class="btn primary">Use this location</button>
      <button id="clearPick" class="btn">Clear</button>
    </div>
  </div>
</div>

<script type="module" src="js/app.js"></script>
<script type="module" src="js/cloudinary.js"></script>
<script type="module" src="js/dashboard.js"></script>
<script type="module" src="js/map-pick.js"></script>
</body>
</html>
